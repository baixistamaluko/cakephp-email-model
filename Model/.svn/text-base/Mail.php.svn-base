<?php
App::uses('AppModel', 'Model');
/**
 * Mail Model
 *
 */
class Mail extends AppModel {
/**
 * Validation rules
 *
 * @var array
 */
	public $validate = array(
		'sent' => array(
			'boolean' => array(
				'rule' => array('boolean'),
				//'message' => 'Your custom message here',
				//'allowEmpty' => false,
				//'required' => false,
				//'last' => false, // Stop validation after this rule
				//'on' => 'create', // Limit validation to 'create' or 'update' operations
			),
		),
	);

function sendEmail($template,$name,$email,$subject,$options,$when=null){
		$data = array(
			'template' => $template, 
			'name' => $name, 
			'subject' => $subject,
			'email' => $email,
			'options'=>$options
		);
		//SELECT DATE_ADD(DATE(now()), INTERVAL 3 DAY);
		
		if($when!=null){
			$when =  DboSource::expression('DATE_ADD(now(),INTERVAL ' . $when . ' DAY)');
		}
		$this->create();
		$this->save(array('when'=>$when, 'data' => json_encode($data)));
	
}

}
